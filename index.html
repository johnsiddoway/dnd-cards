<!doctype html>
<html lang="en">
    <head>
        <meta charset="utf-8">
        <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
        <link rel="stylesheet" href="styles.css">
    </head>
    <body>
        <header class="float-right">
            <div class="selectors" data-bind="">
                <div class="available" data-bind="foreach: monsters">
                    <div class="monster noselect" data-bind="click: $root.selectMonster">
                        <span data-bind="text: name"></span>
                    </div>
                </div>
                <div class="selected" data-bind="foreach: monstersSelected">
                    <div class="monster noselect" data-bind="click: $root.removeMonster">
                        <span data-bind="text: name"></span>
                    </div>
                </div>
            </div>
        </header>
        <main role="main">
            <div class="flexbox" data-bind="foreach: monstersSelected">
                <div class="statblock" data-bind="class: pageSize">
                    <div class="header">
                        <div class="challenge-rating float-right">CR: <span data-bind="text: challengeRating"></span></div>
                        <div class="name" data-bind="text: name"></div>
                        <div class="creature-type"><em>(<span data-bind="text: creatureType"></span>, <span data-bind="text: creatureAlignment"></span>)</em></div>
                    </div>
                    <div class="row">
                        <div class="column">
                            <div><strong>Armor Class: <span data-bind="text: armorClass"></span></strong> (<span data-bind="text: armorDescription"></span>)</div>
                            <div><strong>Hit Points: <span data-bind="text: hitPoints"></span></strong> (<span data-bind="text: hitPointsDescription"></span>)</div>
                            <div><strong>Speed:</strong> <span data-bind="text: speed"></span></div> 
                            <table>
                                <thead>
                                    <tr>
                                        <th>STR</th>
                                        <th>DEX</th>
                                        <th>CON</th>
                                        <th>INT</th>
                                        <th>WIS</th>
                                        <th>CHA</th>
                                    </tr>
                                </thead>
                                <tbody>
                                    <tr data-bind="foreach: abilityScores">
                                        <td><span data-bind="visible: $data >= 10">+</span><span data-bind="text: $root.abilityScoreModifiers[$data]"></span></td>
                                    </tr>
                                </tbody>
                            </table>
                            <div data-bind="visible: savingThrows"><strong>Saving Throws</strong> <span data-bind="text: savingThrows"></span></div>
                            <div data-bind="visible: skills"><strong>Skills</strong> <span data-bind="text: skills"></span></div>
                            <div data-bind="visible: damageResistances"><strong>Damage Resistances</strong> <span data-bind="text: damageResistances"></span></div>
                            <div data-bind="visible: damageImmunities"><strong>Damage Immunities</strong> <span data-bind="text: damageImmunities"></span></div>
                            <div data-bind="visible: conditionImmunities"><strong>Condition Immunities</strong> <span data-bind="text: conditionImmunities"></span></div>
                            <div data-bind="visible: senses"><strong>Senses</strong> <span data-bind="text: senses"></span></div>
                            <div data-bind="visible: languages"><strong>Languages</strong> <span data-bind="text: languages"></span></div>
                            <!-- ko foreach: abilities -->
                            <div><strong data-bind="text: name"></strong> <span data-bind="text: description"></span></div>
                            <!-- /ko -->
                            <div data-bind="visible: innateSpellcasting.description">
                                <strong>Innate Spellcasting: </strong> <span data-bind="text: innateSpellcasting.description"></span>
                                <!-- ko foreach: innateSpellcasting.spells -->
                                <div><span data-bind="text: level"></span> <em data-bind="text: spells"></em></div>
                                <!-- /ko -->
                            </div>
                        </div>
                        <div class="column">
                            <div data-bind="visible: spellcasting.description"><strong>Spellcasting: </strong> <span data-bind="text: spellcasting.description"></span></div>
                            <!-- ko foreach: spellcasting.spells -->
                            <div><span data-bind="text: level"></span> (<span data-bind="text: slots"></span>): <em data-bind="text: spells"></em></div>
                            <!-- /ko -->
                            <div data-bind="visible: actions.length > 0">
                                <h3>Actions</h3>
                                <!-- ko foreach: actions -->
                                <div><strong data-bind="text: name"></strong> <span data-bind="text: description"></span></div>
                                <!-- /ko -->
                            </div>
                            <div data-bind="visible: legendaryActions.description">
                                <h3>Legendary Actions</h3>
                                <span data-bind="text: spellcasting.description"></span>
                            </div>
                            <!-- ko foreach: legendaryActions.actions -->
                            <div><strong data-bind="text: name"></strong> <span data-bind="text: description"></span></div>
                            <!-- /ko -->
                        </div>
                    </div> <!-- /stats -->
                </div> <!-- /block -->
            </div>
        </main>
        <script src="https://code.jquery.com/jquery-3.5.1.slim.min.js" integrity="sha384-DfXdz2htPH0lsSSs5nCTpuj/zy4C+OGpamoFVy38MVBnE+IbbVYUew+OrCXaRkfj" crossorigin="anonymous"></script>
        <script src="https://cdnjs.cloudflare.com/ajax/libs/knockout/3.5.0/knockout-min.js"></script>
        <!-- If you want to change the list of monsters / NPCs, uncomment the local reference and comment the Github URL -->
        <script type="text/javascript" src="page.js"></script>
        <script type="text/javascript" src="data.js"></script>
        <script type="text/javascript" src="custom-data.js"></script>
        <!-- <script type="text/javascript" src="https://raw.githubusercontent.com/johnsiddoway/dnd-cards/main/data.js" crossorigin="anonymous"></script> -->
        <script type="text/javascript">
            var page = new Page();
            $(document).ready(function () {
                data.monsters.push(...customData.monsters); // combine the SRD stats with non-SRD stats
                data.monsters.sort((a,b) => (a.pageSize < b.pageSize)
                    ? (a.name > b.name) ? 1 : -1
                    : (a.name > b.name) ? 1 : -1
                );
                page.init(data.monsters);
                ko.applyBindings(page);
            });
        </script>
    </body>
</html>